[{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\api\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\components\\CredibilityBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\components\\FetchModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'data' is defined but never used. Allowed unused args must match /^_/u.","line":35,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":35,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react'\r\nimport { useQuery, useMutation } from '@tanstack/react-query'\r\nimport { fetchApi } from '../api/client'\r\nimport { Loader2, X, DownloadCloud, Check } from 'lucide-react'\r\nimport { toast } from 'react-hot-toast'\r\n\r\nimport { Source } from '../types'\r\n\r\ninterface FetchModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n}\r\n\r\nexport function FetchModal({ isOpen, onClose }: FetchModalProps) {\r\n  const [selectedSources, setSelectedSources] = useState<string[]>([])\r\n  const [daysBack, setDaysBack] = useState(7)\r\n  const [maxResults, setMaxResults] = useState(50)\r\n\r\n  // Fetch available sources\r\n  const { data: sourcesData, isLoading: isLoadingSources, isError, error } = useQuery({\r\n    queryKey: ['fetch-sources'],\r\n    queryFn: fetchApi.getSources,\r\n    enabled: isOpen,\r\n  })\r\n\r\n  // Pre-select all sources when loaded\r\n  useEffect(() => {\r\n    if (sourcesData?.data?.sources) {\r\n      setSelectedSources(sourcesData.data.sources.map((s: Source) => s.id))\r\n    }\r\n  }, [sourcesData])\r\n\r\n  const fetchMutation = useMutation({\r\n    mutationFn: fetchApi.start,\r\n    onSuccess: (data) => {\r\n      toast.success('Fetch job started successfully!')\r\n      onClose()\r\n    },\r\n    onError: (error) => {\r\n      toast.error('Failed to start fetch job')\r\n      console.error(error)\r\n    },\r\n  })\r\n\r\n  const handleFetch = () => {\r\n    fetchMutation.mutate({\r\n      sources: selectedSources,\r\n      days_back: daysBack,\r\n      max_results: maxResults,\r\n    })\r\n  }\r\n\r\n  const toggleSource = (sourceId: string) => {\r\n    if (selectedSources.includes(sourceId)) {\r\n      setSelectedSources(selectedSources.filter((id) => id !== sourceId))\r\n    } else {\r\n      setSelectedSources([...selectedSources, sourceId])\r\n    }\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-lg border border-gray-200 dark:border-gray-700\">\r\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-100 dark:border-gray-700\">\r\n            <div className=\"flex items-center gap-3\">\r\n                <div className=\"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg\">\r\n                    <DownloadCloud className=\"w-5 h-5 text-blue-600 dark:text-blue-400\" />\r\n                </div>\r\n                <div>\r\n                    <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">Fetch New Content</h2>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400\">Crawl sources for latest papers</p>\r\n                </div>\r\n            </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 text-gray-400 hover:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Settings */}\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Days Back\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n                min=\"1\"\r\n                max=\"30\"\r\n                value={daysBack}\r\n                onChange={(e) => setDaysBack(Number(e.target.value))}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                Max Results (per source)\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n                min=\"1\"\r\n                max=\"100\"\r\n                value={maxResults}\r\n                onChange={(e) => setMaxResults(Number(e.target.value))}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 outline-none\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Sources List */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3\">\r\n              Select Sources\r\n            </label>\r\n            {isLoadingSources ? (\r\n              <div className=\"flex items-center justify-center p-8 bg-gray-50 dark:bg-gray-900/50 rounded-lg\">\r\n                <Loader2 className=\"w-6 h-6 animate-spin text-gray-400\" />\r\n              </div>\r\n            ) : isError ? (\r\n                <div className=\"p-4 bg-red-50 dark:bg-red-900/10 text-red-600 dark:text-red-400 rounded-lg text-sm text-center\">\r\n                    Failed to load sources. Please try again.\r\n                    <br/>\r\n                    <span className=\"text-xs opacity-70\">{(error as Error)?.message}</span>\r\n                </div>\r\n            ) : !sourcesData?.data?.sources || sourcesData.data.sources.length === 0 ? (\r\n                <div className=\"p-8 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg text-gray-500\">\r\n                    No sources available.\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid grid-cols-2 gap-2 max-h-60 overflow-y-auto p-1\">\r\n                {sourcesData?.data?.sources?.map((source: Source) => (\r\n                    <button\r\n                    key={source.id}\r\n                    onClick={() => toggleSource(source.id)}\r\n                    className={`flex items-center gap-3 p-3 rounded-lg border text-left transition-all ${\r\n                        selectedSources.includes(source.id)\r\n                        ? 'bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800'\r\n                        : 'bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 hover:border-gray-300'\r\n                    }`}\r\n                    >\r\n                    <div className={`w-5 h-5 rounded border flex items-center justify-center transition-colors ${\r\n                        selectedSources.includes(source.id)\r\n                        ? 'bg-blue-500 border-blue-500'\r\n                        : 'border-gray-300 dark:border-gray-600'\r\n                    }`}>\r\n                        {selectedSources.includes(source.id) && (\r\n                            <Check className=\"w-3.5 h-3.5 text-white\" />\r\n                        )}\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"font-medium text-sm text-gray-900 dark:text-white\">\r\n                            {source.name}\r\n                        </div>\r\n                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                            {source.type}\r\n                        </div>\r\n                    </div>\r\n                    </button>\r\n                ))}\r\n                </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-6 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-3 bg-gray-50 dark:bg-gray-800/50 rounded-b-xl\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-white dark:hover:bg-gray-700 border border-transparent hover:border-gray-200 dark:hover:border-gray-600 rounded-lg transition-all\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleFetch}\r\n            disabled={fetchMutation.isPending || selectedSources.length === 0}\r\n            className=\"flex items-center gap-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm hover:shadow transition-all disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            {fetchMutation.isPending ? (\r\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n            ) : (\r\n              <DownloadCloud className=\"w-4 h-4\" />\r\n            )}\r\n            Start Fetching\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\components\\Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\components\\PaperCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\components\\PdfUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\components\\StatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\contexts\\BrandingContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":51,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":51,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useEffect, useState } from 'react'\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { settingsApi } from '../api/client'\r\n\r\nexport interface Branding {\r\n  app_name: string\r\n  tagline: string\r\n  primary_color: string\r\n  secondary_color: string\r\n  newsletter_title: string\r\n  footer_text: string\r\n  item_terminology: string\r\n  item_terminology_plural: string\r\n}\r\n\r\nexport interface Domain {\r\n  id: string\r\n  name: string\r\n  description: string\r\n  icon: string\r\n  primary_color: string\r\n}\r\n\r\ninterface BrandingContextType {\r\n  branding: Branding | null\r\n  domains: Domain[]\r\n  activeDomainId: string | null\r\n  isLoading: boolean\r\n  setActiveDomain: (domainId: string) => Promise<void>\r\n}\r\n\r\nconst defaultBranding: Branding = {\r\n  app_name: 'Science Digest',\r\n  tagline: 'Your daily dose of scientific discovery',\r\n  primary_color: '#0984e3',\r\n  secondary_color: '#6c5ce7',\r\n  newsletter_title: 'Science Digest Newsletter',\r\n  footer_text: 'Stay curious!',\r\n  item_terminology: 'paper',\r\n  item_terminology_plural: 'papers',\r\n}\r\n\r\nconst BrandingContext = createContext<BrandingContextType>({\r\n  branding: defaultBranding,\r\n  domains: [],\r\n  activeDomainId: null,\r\n  isLoading: true,\r\n  setActiveDomain: async () => {},\r\n})\r\n\r\nexport const useBranding = () => useContext(BrandingContext)\r\n\r\nexport const BrandingProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const queryClient = useQueryClient()\r\n  const [activeDomainId, setActiveDomainId] = useState<string | null>(null)\r\n\r\n  // Fetch current branding\r\n  const { data: brandingData, isLoading: brandingLoading } = useQuery({\r\n    queryKey: ['branding'],\r\n    queryFn: async () => {\r\n      const response = await settingsApi.getBranding()\r\n      return response.data as Branding & { domain_id: string }\r\n    },\r\n    staleTime: 5 * 60 * 1000, // 5 minutes\r\n  })\r\n\r\n  // Fetch available domains\r\n  const { data: domainsData, isLoading: domainsLoading } = useQuery({\r\n    queryKey: ['domains'],\r\n    queryFn: async () => {\r\n      const response = await settingsApi.getDomains()\r\n      return response.data.domains as Domain[]\r\n    },\r\n    staleTime: 10 * 60 * 1000, // 10 minutes\r\n  })\r\n\r\n  // Set active domain mutation\r\n  const setDomainMutation = useMutation({\r\n    mutationFn: async (domainId: string) => {\r\n      await settingsApi.setActiveDomain(domainId)\r\n      return domainId\r\n    },\r\n    onSuccess: () => {\r\n      // Invalidate branding to refetch with new domain\r\n      queryClient.invalidateQueries({ queryKey: ['branding'] })\r\n    },\r\n  })\r\n\r\n  // Update activeDomainId when branding loads\r\n  useEffect(() => {\r\n    if (brandingData && 'domain_id' in brandingData) {\r\n      setActiveDomainId(brandingData.domain_id)\r\n    }\r\n  }, [brandingData])\r\n\r\n  const handleSetActiveDomain = async (domainId: string) => {\r\n    await setDomainMutation.mutateAsync(domainId)\r\n    setActiveDomainId(domainId)\r\n  }\r\n\r\n  // Apply primary color as CSS variable\r\n  useEffect(() => {\r\n    if (brandingData?.primary_color) {\r\n      document.documentElement.style.setProperty('--primary-color', brandingData.primary_color)\r\n      document.documentElement.style.setProperty('--secondary-color', brandingData.secondary_color || '#6c5ce7')\r\n    }\r\n  }, [brandingData])\r\n\r\n  const value: BrandingContextType = {\r\n    branding: brandingData || defaultBranding,\r\n    domains: domainsData || [],\r\n    activeDomainId,\r\n    isLoading: brandingLoading || domainsLoading,\r\n    setActiveDomain: handleSetActiveDomain,\r\n  }\r\n\r\n  return (\r\n    <BrandingContext.Provider value={value}>\r\n      {children}\r\n    </BrandingContext.Provider>\r\n  )\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\DigestDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Digests.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Fetch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\LivePulse.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refetch' is assigned a value but never used.","line":62,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":62,"endColumn":12},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":157,"column":5,"severity":2,"nodeType":null,"fix":{"range":[4964,5019],"text":" "}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { toast } from 'react-hot-toast'\r\nimport { useState, useEffect, useRef } from 'react'\r\nimport {\r\n  Zap,\r\n  AlertTriangle,\r\n  Clock,\r\n  RefreshCw,\r\n  Filter,\r\n  ExternalLink,\r\n  Loader2,\r\n  Radio,\r\n  TrendingUp,\r\n  Bell,\r\n  BellOff,\r\n  DownloadCloud,\r\n} from 'lucide-react'\r\nimport { useBranding } from '../contexts/BrandingContext'\r\nimport { api } from '../api/client'\r\nimport { FetchModal } from '../components/FetchModal'\r\n\r\ninterface PulsePaper {\r\n  id: number\r\n  title: string\r\n  abstract: string | null\r\n  source: string\r\n  url: string | null\r\n  published_date: string | null\r\n  is_breaking: boolean\r\n  breaking_score: number | null\r\n  breaking_keywords: string[] | null\r\n  freshness_score: number | null\r\n  triage_status: string | null\r\n  triage_score: number | null\r\n  is_validated_source?: boolean\r\n  fetched_at: string\r\n}\r\n\r\ninterface FeedStats {\r\n  time_window_hours: number\r\n  total_papers: number\r\n  breaking_count: number\r\n  passed_triage_count: number\r\n  avg_freshness_score: number\r\n  breaking_rate: number\r\n}\r\n\r\nexport default function LivePulse() {\r\n  const queryClient = useQueryClient()\r\n  const { activeDomainId } = useBranding()\r\n  const [breakingOnly, setBreakingOnly] = useState(false)\r\n  const [validatedOnly, setValidatedOnly] = useState(false)\r\n  const [autoRefresh, setAutoRefresh] = useState(true)\r\n  const [showBreakingAlert, setShowBreakingAlert] = useState(true)\r\n  const [showFetchModal, setShowFetchModal] = useState(false)\r\n  const lastFetchTime = useRef<string | null>(null)\r\n\r\n  // Fetch feed\r\n  const {\r\n    data: feed,\r\n    isLoading,\r\n    refetch,\r\n  } = useQuery({\r\n    queryKey: ['pulse-feed', activeDomainId, breakingOnly, validatedOnly],\r\n    queryFn: async () => {\r\n      const response = await api.get('/pulse/feed', {\r\n        params: {\r\n          domain_id: activeDomainId,\r\n          limit: 50,\r\n          breaking_only: breakingOnly,\r\n          passed_triage_only: true,\r\n          validated_only: validatedOnly,\r\n        },\r\n      })\r\n      return response.data as PulsePaper[]\r\n    },\r\n    refetchInterval: autoRefresh ? 30000 : false, // Refresh every 30 seconds if enabled\r\n  })\r\n\r\n  // Fetch stats\r\n  const { data: stats } = useQuery({\r\n    queryKey: ['pulse-stats', activeDomainId],\r\n    queryFn: async () => {\r\n      const response = await api.get('/pulse/stats', {\r\n        params: { domain_id: activeDomainId, hours_back: 24 },\r\n      })\r\n      return response.data as FeedStats\r\n    },\r\n    refetchInterval: 60000, // Refresh stats every minute\r\n  })\r\n\r\n  // Fetch breaking news\r\n  const { data: breaking } = useQuery({\r\n    queryKey: ['pulse-breaking', activeDomainId],\r\n    queryFn: async () => {\r\n      const response = await api.get('/pulse/breaking', {\r\n        params: { domain_id: activeDomainId, limit: 5 },\r\n      })\r\n      return response.data as PulsePaper[]\r\n    },\r\n    refetchInterval: autoRefresh ? 15000 : false, // Check breaking every 15 seconds\r\n  })\r\n\r\n  // Refresh scores mutation\r\n  const refreshMutation = useMutation({\r\n    mutationFn: () =>\r\n      api.post('/pulse/refresh', null, {\r\n        params: { domain_id: activeDomainId, hours_back: 48 },\r\n      }),\r\n    onSuccess: (response) => {\r\n      const data = response.data\r\n      toast.success(\r\n        `Refreshed ${data.papers_updated} papers, ${data.new_breaking} new breaking`\r\n      )\r\n      queryClient.invalidateQueries({ queryKey: ['pulse-feed'] })\r\n      queryClient.invalidateQueries({ queryKey: ['pulse-breaking'] })\r\n      queryClient.invalidateQueries({ queryKey: ['pulse-stats'] })\r\n    },\r\n    onError: () => {\r\n      toast.error('Failed to refresh scores')\r\n    },\r\n  })\r\n\r\n  // Check for new breaking news\r\n  useEffect(() => {\r\n    if (breaking && breaking.length > 0 && showBreakingAlert) {\r\n      const latestBreaking = breaking[0]\r\n      if (\r\n        lastFetchTime.current &&\r\n        new Date(latestBreaking.fetched_at) > new Date(lastFetchTime.current)\r\n      ) {\r\n        toast.custom(\r\n          (t) => (\r\n            <div\r\n              className={`${\r\n                t.visible ? 'animate-enter' : 'animate-leave'\r\n              } max-w-md w-full bg-red-600 text-white shadow-lg rounded-lg pointer-events-auto flex ring-1 ring-black ring-opacity-5`}\r\n            >\r\n              <div className=\"flex-1 w-0 p-4\">\r\n                <div className=\"flex items-start\">\r\n                  <AlertTriangle className=\"w-6 h-6 flex-shrink-0\" />\r\n                  <div className=\"ml-3 flex-1\">\r\n                    <p className=\"text-sm font-medium\">BREAKING NEWS</p>\r\n                    <p className=\"mt-1 text-sm opacity-90\">\r\n                      {latestBreaking.title}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ),\r\n          { duration: 5000 }\r\n        )\r\n      }\r\n      lastFetchTime.current = new Date().toISOString()\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [breaking, showBreakingAlert])\r\n\r\n  const formatTime = (dateStr: string | null) => {\r\n    if (!dateStr) return 'Unknown'\r\n    const date = new Date(dateStr)\r\n    const now = new Date()\r\n    const diffMs = now.getTime() - date.getTime()\r\n    const diffMins = Math.floor(diffMs / 60000)\r\n    const diffHours = Math.floor(diffMins / 60)\r\n    const diffDays = Math.floor(diffHours / 24)\r\n\r\n    if (diffMins < 1) return 'Just now'\r\n    if (diffMins < 60) return `${diffMins}m ago`\r\n    if (diffHours < 24) return `${diffHours}h ago`\r\n    return `${diffDays}d ago`\r\n  }\r\n\r\n  const getFreshnessColor = (score: number | null) => {\r\n    if (!score) return 'text-gray-400'\r\n    if (score >= 0.8) return 'text-green-500'\r\n    if (score >= 0.5) return 'text-yellow-500'\r\n    if (score >= 0.3) return 'text-orange-500'\r\n    return 'text-red-500'\r\n  }\r\n\r\n  const getScoreBadge = (score: number | null) => {\r\n    if (!score) return null\r\n    const percentage = Math.round(score * 100)\r\n    return (\r\n      <span\r\n        className={`text-xs font-medium ${getFreshnessColor(score)}`}\r\n        title={`Freshness: ${percentage}%`}\r\n      >\r\n        {percentage}%\r\n      </span>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2\">\r\n            <Radio className=\"w-7 h-7 text-red-500\" />\r\n            Live Pulse\r\n          </h1>\r\n          <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\r\n            Real-time feed with breaking news detection\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <button\r\n            onClick={() => setShowBreakingAlert(!showBreakingAlert)}\r\n            className={`p-2 rounded-lg ${\r\n              showBreakingAlert\r\n                ? 'bg-red-100 text-red-600'\r\n                : 'bg-gray-100 text-gray-500'\r\n            }`}\r\n            title={showBreakingAlert ? 'Alerts on' : 'Alerts off'}\r\n          >\r\n            {showBreakingAlert ? (\r\n              <Bell className=\"w-5 h-5\" />\r\n            ) : (\r\n              <BellOff className=\"w-5 h-5\" />\r\n            )}\r\n          </button>\r\n          <button\r\n            onClick={() => setAutoRefresh(!autoRefresh)}\r\n            className={`flex items-center gap-2 px-3 py-2 rounded-lg ${\r\n              autoRefresh\r\n                ? 'bg-green-100 text-green-700'\r\n                : 'bg-gray-100 text-gray-600'\r\n            }`}\r\n          >\r\n            <Radio\r\n              className={`w-4 h-4 ${autoRefresh ? 'animate-pulse' : ''}`}\r\n            />\r\n            {autoRefresh ? 'Live' : 'Paused'}\r\n          </button>\r\n          <button\r\n            onClick={() => setShowFetchModal(true)}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\r\n          >\r\n             <DownloadCloud className=\"w-4 h-4\" />\r\n             Fetch Content\r\n          </button>\r\n          <button\r\n            onClick={() => refreshMutation.mutate()}\r\n            disabled={refreshMutation.isPending}\r\n            className=\"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90\"\r\n          >\r\n            {refreshMutation.isPending ? (\r\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n            ) : (\r\n              <RefreshCw className=\"w-4 h-4\" />\r\n            )}\r\n            Refresh Scores\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Bar */}\r\n      {stats && (\r\n        <div className=\"grid grid-cols-4 gap-4\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n            <div className=\"text-sm text-gray-500\">Total (24h)</div>\r\n            <div className=\"text-2xl font-bold\">{stats.total_papers}</div>\r\n          </div>\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-red-200 dark:border-red-800\">\r\n            <div className=\"text-sm text-gray-500 flex items-center gap-1\">\r\n              <AlertTriangle className=\"w-4 h-4 text-red-500\" />\r\n              Breaking\r\n            </div>\r\n            <div className=\"text-2xl font-bold text-red-600\">\r\n              {stats.breaking_count}\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-green-200 dark:border-green-800\">\r\n            <div className=\"text-sm text-gray-500\">Passed Triage</div>\r\n            <div className=\"text-2xl font-bold text-green-600\">\r\n              {stats.passed_triage_count}\r\n            </div>\r\n          </div>\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700\">\r\n            <div className=\"text-sm text-gray-500\">Avg Freshness</div>\r\n            <div\r\n              className={`text-2xl font-bold ${getFreshnessColor(\r\n                stats.avg_freshness_score\r\n              )}`}\r\n            >\r\n              {Math.round(stats.avg_freshness_score * 100)}%\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Breaking News Banner */}\r\n      {breaking && breaking.length > 0 && (\r\n        <div className=\"bg-red-600 text-white rounded-lg p-4\">\r\n          <div className=\"flex items-center gap-2 mb-2\">\r\n            <Zap className=\"w-5 h-5\" />\r\n            <span className=\"font-bold\">BREAKING NEWS</span>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            {breaking.slice(0, 3).map((item) => (\r\n              <div\r\n                key={item.id}\r\n                className=\"flex items-center justify-between bg-red-700/50 rounded p-2\"\r\n              >\r\n                <div className=\"flex-1\">\r\n                  <a\r\n                    href={item.url || '#'}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    className=\"hover:underline font-medium\"\r\n                  >\r\n                    {item.title}\r\n                  </a>\r\n                  <div className=\"text-sm opacity-75 mt-1\">\r\n                    {item.source} • {formatTime(item.fetched_at)}\r\n                  </div>\r\n                </div>\r\n                {item.breaking_score && (\r\n                  <div className=\"text-sm bg-red-800 px-2 py-1 rounded\">\r\n                    {Math.round(item.breaking_score * 100)}% urgency\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Filter Bar */}\r\n      <div className=\"flex items-center gap-4 bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700\">\r\n        <Filter className=\"w-5 h-5 text-gray-400\" />\r\n        <label className=\"flex items-center gap-2\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={breakingOnly}\r\n            onChange={(e) => setBreakingOnly(e.target.checked)}\r\n            className=\"rounded\"\r\n          />\r\n          <span className=\"text-sm\">Breaking only</span>\r\n        </label>\r\n        <label className=\"flex items-center gap-2 ml-2\">\r\n            <input\r\n                type=\"checkbox\"\r\n                checked={validatedOnly}\r\n                onChange={(e) => setValidatedOnly(e.target.checked)}\r\n                className=\"rounded\"\r\n            />\r\n            <span className=\"text-sm flex items-center gap-1\">Validated only</span>\r\n        </label>\r\n        <span className=\"text-gray-300\">|</span>\r\n        <span className=\"text-sm text-gray-500\">\r\n          Showing {feed?.length || 0} items\r\n        </span>\r\n      </div>\r\n\r\n      {/* Feed */}\r\n      {isLoading ? (\r\n        <div className=\"flex items-center justify-center h-64\">\r\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n        </div>\r\n      ) : feed && feed.length > 0 ? (\r\n        <div className=\"space-y-3\">\r\n          {feed.map((item) => (\r\n            <div\r\n              key={item.id}\r\n              className={`p-4 bg-white dark:bg-gray-800 rounded-lg border ${\r\n                item.is_breaking\r\n                  ? 'border-red-300 dark:border-red-700 ring-1 ring-red-200'\r\n                  : 'border-gray-200 dark:border-gray-700'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2 mb-1\">\r\n                    {item.is_breaking && (\r\n                      <span className=\"px-2 py-0.5 text-xs font-bold bg-red-600 text-white rounded\">\r\n                        BREAKING ({Math.round((item.breaking_score || 0) * 100)}%)\r\n                      </span>\r\n                    )}\r\n                    {item.is_validated_source && (\r\n                        <span className=\"px-2 py-0.5 text-xs font-bold bg-green-100 text-green-700 rounded border border-green-200\">\r\n                            VALIDATED\r\n                        </span>\r\n                    )}\r\n\r\n                    <span className=\"text-sm text-gray-500\">{item.source}</span>\r\n                    <span className=\"text-gray-300\">•</span>\r\n                    <span className=\"text-sm text-gray-500 flex items-center gap-1\">\r\n                      <Clock className=\"w-3 h-3\" />\r\n                      {formatTime(item.fetched_at)}\r\n                    </span>\r\n                    {getScoreBadge(item.freshness_score)}\r\n                  </div>\r\n\r\n                  <h3 className=\"font-medium text-lg\">\r\n                    {item.url ? (\r\n                      <a\r\n                        href={item.url}\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                        className=\"hover:text-primary flex items-center gap-1\"\r\n                      >\r\n                        {item.title}\r\n                        <ExternalLink className=\"w-4 h-4 opacity-50\" />\r\n                      </a>\r\n                    ) : (\r\n                      item.title\r\n                    )}\r\n                  </h3>\r\n\r\n                  {item.abstract && (\r\n                    <p className=\"text-gray-600 dark:text-gray-400 mt-2 text-sm line-clamp-2\">\r\n                      {item.abstract}\r\n                    </p>\r\n                  )}\r\n\r\n                  {item.breaking_keywords && item.breaking_keywords.length > 0 && (\r\n                    <div className=\"flex gap-2 mt-2\">\r\n                      {item.breaking_keywords.map((kw, i) => (\r\n                        <span\r\n                          key={i}\r\n                          className=\"px-2 py-0.5 text-xs bg-red-100 text-red-700 rounded\"\r\n                        >\r\n                          {kw}\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"text-right\">\r\n                  {item.breaking_score && (\r\n                    <div className=\"flex items-center gap-1 text-sm\">\r\n                      <TrendingUp className=\"w-4 h-4 text-red-500\" />\r\n                      <span className=\"text-red-600 font-medium\">\r\n                        {Math.round(item.breaking_score * 100)}%\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                  {item.triage_score && (\r\n                    <div className=\"text-xs text-gray-500 mt-1\">\r\n                      Quality: {Math.round(item.triage_score * 100)}%\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        <div className=\"text-center py-12 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700\">\r\n          <Radio className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n            No items in feed\r\n          </h3>\r\n          <p className=\"text-gray-500 mt-1\">\r\n            {breakingOnly\r\n              ? 'No breaking news at the moment'\r\n              : 'Fetch some content to see the live feed'}\r\n          </p>\r\n        </div>\r\n      )}\r\n      \r\n      <FetchModal isOpen={showFetchModal} onClose={() => setShowFetchModal(false)} />\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\NewsletterEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Newsletters.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":10,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":11}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery } from '@tanstack/react-query'\r\nimport { Link } from 'react-router-dom'\r\nimport { \r\n  Mail, \r\n  Clock, \r\n  FileText,\r\n  Loader2,\r\n  Edit3,\r\n  Send,\r\n  Download,\r\n  CheckCircle\r\n} from 'lucide-react'\r\nimport { format } from 'date-fns'\r\nimport { digestsApi } from '../api/client'\r\nimport { Digest } from '../types'\r\n\r\nexport default function Newsletters() {\r\n  const { data, isLoading } = useQuery({\r\n    queryKey: ['digests', 'completed'],\r\n    queryFn: () => digestsApi.list({ limit: 50, status: 'completed' }),\r\n  })\r\n  \r\n  const digests = (data?.data?.digests || []) as Digest[]\r\n  \r\n  return (\r\n    <div className=\"space-y-6 animate-fade-in\">\r\n      {/* Header */}\r\n      <div>\r\n        <h1 className=\"font-display text-3xl font-semibold text-ink-50\">\r\n          Newsletters\r\n        </h1>\r\n        <p className=\"text-ink-400 mt-1\">\r\n          Edit and format digests before publishing to readers\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Newsletter List */}\r\n      {isLoading ? (\r\n        <div className=\"flex items-center justify-center py-12\">\r\n          <Loader2 className=\"w-8 h-8 text-science-500 animate-spin\" />\r\n        </div>\r\n      ) : digests.length === 0 ? (\r\n        <div className=\"card p-12 text-center\">\r\n          <Mail className=\"w-12 h-12 text-ink-600 mx-auto mb-4\" />\r\n          <h3 className=\"text-lg font-medium text-ink-300 mb-2\">\r\n            No newsletters ready\r\n          </h3>\r\n          <p className=\"text-ink-500 mb-4\">\r\n            Complete a digest first to create a newsletter\r\n          </p>\r\n          <Link to=\"/digests\" className=\"btn-primary\">\r\n            <FileText className=\"w-4 h-4\" />\r\n            View Digests\r\n          </Link>\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid gap-4\">\r\n          {digests.map((digest) => (\r\n            <div \r\n              key={digest.id}\r\n              className=\"card p-5 hover:border-ink-600 transition-colors\"\r\n            >\r\n              <div className=\"flex items-start justify-between\">\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <CheckCircle className=\"w-4 h-4 text-green-400\" />\r\n                    <h3 className=\"font-display text-lg font-medium text-ink-100\">\r\n                      {digest.name}\r\n                    </h3>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex flex-wrap items-center gap-4 mt-2 text-sm text-ink-400\">\r\n                    <span className=\"flex items-center gap-1\">\r\n                      <Clock className=\"w-3.5 h-3.5\" />\r\n                      {format(new Date(digest.created_at), 'MMM d, yyyy')}\r\n                    </span>\r\n                    <span className=\"flex items-center gap-1\">\r\n                      <FileText className=\"w-3.5 h-3.5\" />\r\n                      {digest.digest_papers?.length || 0} papers\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  {digest.intro_text && (\r\n                    <p className=\"text-ink-400 text-sm mt-3 line-clamp-2\">\r\n                      {digest.intro_text}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n                \r\n                <div className=\"flex items-center gap-2 ml-4\">\r\n                  <Link\r\n                    to={`/newsletters/${digest.id}/edit`}\r\n                    className=\"btn-secondary text-sm py-2 px-3\"\r\n                  >\r\n                    <Edit3 className=\"w-4 h-4\" />\r\n                    Edit\r\n                  </Link>\r\n                  <Link\r\n                    to={`/newsletters/${digest.id}/edit`}\r\n                    className=\"btn-primary text-sm py-2 px-3\"\r\n                  >\r\n                    <Send className=\"w-4 h-4\" />\r\n                    Publish\r\n                  </Link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Papers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Schedules.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":11,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { toast } from 'react-hot-toast'\r\nimport { useState } from 'react'\r\nimport {\r\n  Calendar,\r\n  Plus,\r\n  Trash2,\r\n  Play,\r\n  Pause,\r\n  Clock,\r\n  Settings,\r\n  Loader2,\r\n  CheckCircle,\r\n  XCircle,\r\n  History,\r\n  Zap,\r\n} from 'lucide-react'\r\nimport { useBranding } from '../contexts/BrandingContext'\r\nimport { api } from '../api/client'\r\n\r\ninterface DigestSchedule {\r\n  id: number\r\n  domain_id: string\r\n  name: string\r\n  description: string | null\r\n  cron_expression: string\r\n  timezone: string\r\n  is_active: boolean\r\n  lookback_hours: number\r\n  max_items: number\r\n  top_picks_count: number\r\n  cluster_topics: boolean\r\n  min_triage_score: number | null\r\n  only_passed_triage: boolean\r\n  ai_provider: string\r\n  ai_model: string | null\r\n  last_run_at: string | null\r\n  next_run_at: string | null\r\n  run_count: number\r\n  last_error: string | null\r\n  created_at: string\r\n}\r\n\r\ninterface ScheduledDigest {\r\n  id: number\r\n  schedule_id: number\r\n  digest_id: number\r\n  papers_considered: number\r\n  papers_included: number\r\n  topics_clustered: number\r\n  triggered_at: string\r\n  completed_at: string | null\r\n  generation_time_seconds: number | null\r\n}\r\n\r\n// Common cron presets\r\nconst CRON_PRESETS = [\r\n  { label: 'Every morning at 6 AM', value: '0 6 * * *' },\r\n  { label: 'Every evening at 6 PM', value: '0 18 * * *' },\r\n  { label: 'Twice daily (6 AM & 6 PM)', value: '0 6,18 * * *' },\r\n  { label: 'Every hour', value: '0 * * * *' },\r\n  { label: 'Every Monday at 9 AM', value: '0 9 * * 1' },\r\n  { label: 'Custom', value: 'custom' },\r\n]\r\n\r\nexport default function Schedules() {\r\n  const queryClient = useQueryClient()\r\n  const { activeDomainId } = useBranding()\r\n  const [showAddForm, setShowAddForm] = useState(false)\r\n  const [showHistory, setShowHistory] = useState<number | null>(null)\r\n  const [cronPreset, setCronPreset] = useState('0 6 * * *')\r\n  const [customCron, setCustomCron] = useState('')\r\n  const [newSchedule, setNewSchedule] = useState({\r\n    name: '',\r\n    description: '',\r\n    cron_expression: '0 6 * * *',\r\n    timezone: 'UTC',\r\n    lookback_hours: 24,\r\n    max_items: 10,\r\n    top_picks_count: 3,\r\n    cluster_topics: true,\r\n    ai_provider: 'gemini',\r\n  })\r\n\r\n  // Fetch schedules\r\n  const { data: schedules, isLoading } = useQuery({\r\n    queryKey: ['schedules', activeDomainId],\r\n    queryFn: async () => {\r\n      const response = await api.get('/schedules/', {\r\n        params: { domain_id: activeDomainId },\r\n      })\r\n      return response.data as DigestSchedule[]\r\n    },\r\n  })\r\n\r\n  // Fetch history for a schedule\r\n  const { data: history } = useQuery({\r\n    queryKey: ['schedule-history', showHistory],\r\n    queryFn: async () => {\r\n      if (!showHistory) return []\r\n      const response = await api.get(`/schedules/${showHistory}/history`)\r\n      return response.data as ScheduledDigest[]\r\n    },\r\n    enabled: !!showHistory,\r\n  })\r\n\r\n  // Create schedule\r\n  const createMutation = useMutation({\r\n    mutationFn: async (data: typeof newSchedule) => {\r\n      return api.post('/schedules/', {\r\n        ...data,\r\n        domain_id: activeDomainId,\r\n        cron_expression: cronPreset === 'custom' ? customCron : cronPreset,\r\n      })\r\n    },\r\n    onSuccess: () => {\r\n      toast.success('Schedule created successfully')\r\n      queryClient.invalidateQueries({ queryKey: ['schedules'] })\r\n      setShowAddForm(false)\r\n      resetForm()\r\n    },\r\n    onError: () => {\r\n      toast.error('Failed to create schedule')\r\n    },\r\n  })\r\n\r\n  // Toggle schedule\r\n  const toggleMutation = useMutation({\r\n    mutationFn: (id: number) => api.post(`/schedules/${id}/toggle`),\r\n    onSuccess: (response) => {\r\n      const data = response.data\r\n      toast.success(data.message)\r\n      queryClient.invalidateQueries({ queryKey: ['schedules'] })\r\n    },\r\n    onError: () => {\r\n      toast.error('Failed to toggle schedule')\r\n    },\r\n  })\r\n\r\n  // Run now\r\n  const runNowMutation = useMutation({\r\n    mutationFn: (id: number) => api.post(`/schedules/${id}/run-now`),\r\n    onSuccess: (response) => {\r\n      const data = response.data\r\n      if (data.digest_id) {\r\n        toast.success(`Digest created: #${data.digest_id}`)\r\n      } else {\r\n        toast.success(data.message)\r\n      }\r\n      queryClient.invalidateQueries({ queryKey: ['schedules'] })\r\n      queryClient.invalidateQueries({ queryKey: ['digests'] })\r\n    },\r\n    onError: () => {\r\n      toast.error('Failed to run schedule')\r\n    },\r\n  })\r\n\r\n  // Delete schedule\r\n  const deleteMutation = useMutation({\r\n    mutationFn: (id: number) => api.delete(`/schedules/${id}`),\r\n    onSuccess: () => {\r\n      toast.success('Schedule deleted')\r\n      queryClient.invalidateQueries({ queryKey: ['schedules'] })\r\n    },\r\n    onError: () => {\r\n      toast.error('Failed to delete schedule')\r\n    },\r\n  })\r\n\r\n  const resetForm = () => {\r\n    setNewSchedule({\r\n      name: '',\r\n      description: '',\r\n      cron_expression: '0 6 * * *',\r\n      timezone: 'UTC',\r\n      lookback_hours: 24,\r\n      max_items: 10,\r\n      top_picks_count: 3,\r\n      cluster_topics: true,\r\n      ai_provider: 'gemini',\r\n    })\r\n    setCronPreset('0 6 * * *')\r\n    setCustomCron('')\r\n  }\r\n\r\n  const formatDate = (dateStr: string | null) => {\r\n    if (!dateStr) return 'Never'\r\n    return new Date(dateStr).toLocaleString()\r\n  }\r\n\r\n  const formatDuration = (seconds: number | null) => {\r\n    if (!seconds) return '-'\r\n    if (seconds < 60) return `${seconds.toFixed(1)}s`\r\n    return `${Math.floor(seconds / 60)}m ${Math.floor(seconds % 60)}s`\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2\">\r\n            <Calendar className=\"w-7 h-7\" />\r\n            Scheduled Digests\r\n          </h1>\r\n          <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\r\n            Automatically generate digests on a schedule\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowAddForm(true)}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors\"\r\n        >\r\n          <Plus className=\"w-4 h-4\" />\r\n          New Schedule\r\n        </button>\r\n      </div>\r\n\r\n      {/* Add Form Modal */}\r\n      {showAddForm && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Create Schedule</h2>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newSchedule.name}\r\n                  onChange={(e) =>\r\n                    setNewSchedule({ ...newSchedule, name: e.target.value })\r\n                  }\r\n                  placeholder=\"Morning Tech Briefing\"\r\n                  className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">\r\n                  Description (optional)\r\n                </label>\r\n                <textarea\r\n                  value={newSchedule.description}\r\n                  onChange={(e) =>\r\n                    setNewSchedule({\r\n                      ...newSchedule,\r\n                      description: e.target.value,\r\n                    })\r\n                  }\r\n                  placeholder=\"Daily digest of top tech news\"\r\n                  className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                  rows={2}\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">\r\n                  Schedule\r\n                </label>\r\n                <select\r\n                  value={cronPreset}\r\n                  onChange={(e) => setCronPreset(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                >\r\n                  {CRON_PRESETS.map((preset) => (\r\n                    <option key={preset.value} value={preset.value}>\r\n                      {preset.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                {cronPreset === 'custom' && (\r\n                  <input\r\n                    type=\"text\"\r\n                    value={customCron}\r\n                    onChange={(e) => setCustomCron(e.target.value)}\r\n                    placeholder=\"0 6 * * * (minute hour day month day_of_week)\"\r\n                    className=\"w-full mt-2 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 font-mono text-sm\"\r\n                  />\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">\r\n                    Lookback (hours)\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={newSchedule.lookback_hours}\r\n                    onChange={(e) =>\r\n                      setNewSchedule({\r\n                        ...newSchedule,\r\n                        lookback_hours: parseInt(e.target.value) || 24,\r\n                      })\r\n                    }\r\n                    min={1}\r\n                    max={168}\r\n                    className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">\r\n                    Max Items\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={newSchedule.max_items}\r\n                    onChange={(e) =>\r\n                      setNewSchedule({\r\n                        ...newSchedule,\r\n                        max_items: parseInt(e.target.value) || 10,\r\n                      })\r\n                    }\r\n                    min={1}\r\n                    max={50}\r\n                    className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">\r\n                    Top Picks\r\n                  </label>\r\n                  <input\r\n                    type=\"number\"\r\n                    value={newSchedule.top_picks_count}\r\n                    onChange={(e) =>\r\n                      setNewSchedule({\r\n                        ...newSchedule,\r\n                        top_picks_count: parseInt(e.target.value) || 3,\r\n                      })\r\n                    }\r\n                    min={1}\r\n                    max={10}\r\n                    className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">\r\n                    AI Provider\r\n                  </label>\r\n                  <select\r\n                    value={newSchedule.ai_provider}\r\n                    onChange={(e) =>\r\n                      setNewSchedule({\r\n                        ...newSchedule,\r\n                        ai_provider: e.target.value,\r\n                      })\r\n                    }\r\n                    className=\"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600\"\r\n                  >\r\n                    <option value=\"gemini\">Gemini</option>\r\n                    <option value=\"openai\">OpenAI</option>\r\n                    <option value=\"anthropic\">Anthropic</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-4\">\r\n                <label className=\"flex items-center gap-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={newSchedule.cluster_topics}\r\n                    onChange={(e) =>\r\n                      setNewSchedule({\r\n                        ...newSchedule,\r\n                        cluster_topics: e.target.checked,\r\n                      })\r\n                    }\r\n                    className=\"rounded\"\r\n                  />\r\n                  <span className=\"text-sm\">Cluster by topic</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end gap-3 mt-6\">\r\n              <button\r\n                onClick={() => {\r\n                  setShowAddForm(false)\r\n                  resetForm()\r\n                }}\r\n                className=\"px-4 py-2 text-gray-600 hover:text-gray-800\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={() => createMutation.mutate(newSchedule)}\r\n                disabled={!newSchedule.name || createMutation.isPending}\r\n                className=\"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 disabled:opacity-50\"\r\n              >\r\n                {createMutation.isPending && (\r\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                )}\r\n                Create Schedule\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* History Modal */}\r\n      {showHistory && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h2 className=\"text-xl font-semibold flex items-center gap-2\">\r\n                <History className=\"w-5 h-5\" />\r\n                Schedule History\r\n              </h2>\r\n              <button\r\n                onClick={() => setShowHistory(null)}\r\n                className=\"text-gray-500 hover:text-gray-700\"\r\n              >\r\n                Close\r\n              </button>\r\n            </div>\r\n\r\n            {history && history.length > 0 ? (\r\n              <div className=\"space-y-3\">\r\n                {history.map((item) => (\r\n                  <div\r\n                    key={item.id}\r\n                    className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div>\r\n                        <div className=\"font-medium\">\r\n                          Digest #{item.digest_id}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-500\">\r\n                          {formatDate(item.triggered_at)}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-right text-sm\">\r\n                        <div>\r\n                          {item.papers_included} / {item.papers_considered}{' '}\r\n                          papers\r\n                        </div>\r\n                        <div className=\"text-gray-500\">\r\n                          {formatDuration(item.generation_time_seconds)}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-gray-500 text-center py-8\">\r\n                No history yet. Run the schedule to generate digests.\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Schedules List */}\r\n      {schedules && schedules.length > 0 ? (\r\n        <div className=\"grid gap-4\">\r\n          {schedules.map((schedule) => (\r\n            <div\r\n              key={schedule.id}\r\n              className={`p-4 bg-white dark:bg-gray-800 rounded-lg border ${\r\n                schedule.is_active\r\n                  ? 'border-green-200 dark:border-green-800'\r\n                  : 'border-gray-200 dark:border-gray-700'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-start justify-between\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <h3 className=\"font-semibold text-lg\">{schedule.name}</h3>\r\n                    {schedule.is_active ? (\r\n                      <span className=\"px-2 py-0.5 text-xs bg-green-100 text-green-800 rounded-full\">\r\n                        Active\r\n                      </span>\r\n                    ) : (\r\n                      <span className=\"px-2 py-0.5 text-xs bg-gray-100 text-gray-600 rounded-full\">\r\n                        Paused\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                  {schedule.description && (\r\n                    <p className=\"text-gray-500 text-sm mt-1\">\r\n                      {schedule.description}\r\n                    </p>\r\n                  )}\r\n\r\n                  <div className=\"flex flex-wrap gap-4 mt-3 text-sm text-gray-600 dark:text-gray-400\">\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Clock className=\"w-4 h-4\" />\r\n                      <code className=\"bg-gray-100 dark:bg-gray-700 px-1 rounded\">\r\n                        {schedule.cron_expression}\r\n                      </code>\r\n                    </div>\r\n                    <div>\r\n                      {schedule.lookback_hours}h lookback\r\n                    </div>\r\n                    <div>\r\n                      Max {schedule.max_items} items\r\n                    </div>\r\n                    <div>\r\n                      Top {schedule.top_picks_count} picks\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex gap-4 mt-2 text-sm\">\r\n                    <div>\r\n                      <span className=\"text-gray-500\">Last run:</span>{' '}\r\n                      {formatDate(schedule.last_run_at)}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-500\">Next run:</span>{' '}\r\n                      {formatDate(schedule.next_run_at)}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-gray-500\">Total runs:</span>{' '}\r\n                      {schedule.run_count}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {schedule.last_error && (\r\n                    <div className=\"mt-2 text-sm text-red-600 flex items-center gap-1\">\r\n                      <XCircle className=\"w-4 h-4\" />\r\n                      {schedule.last_error}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                  <button\r\n                    onClick={() => setShowHistory(schedule.id)}\r\n                    className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg\"\r\n                    title=\"View history\"\r\n                  >\r\n                    <History className=\"w-5 h-5\" />\r\n                  </button>\r\n                  <button\r\n                    onClick={() => runNowMutation.mutate(schedule.id)}\r\n                    disabled={runNowMutation.isPending}\r\n                    className=\"p-2 text-blue-500 hover:text-blue-700 hover:bg-blue-50 rounded-lg\"\r\n                    title=\"Run now\"\r\n                  >\r\n                    {runNowMutation.isPending ? (\r\n                      <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                    ) : (\r\n                      <Zap className=\"w-5 h-5\" />\r\n                    )}\r\n                  </button>\r\n                  <button\r\n                    onClick={() => toggleMutation.mutate(schedule.id)}\r\n                    className={`p-2 rounded-lg ${\r\n                      schedule.is_active\r\n                        ? 'text-yellow-500 hover:text-yellow-700 hover:bg-yellow-50'\r\n                        : 'text-green-500 hover:text-green-700 hover:bg-green-50'\r\n                    }`}\r\n                    title={schedule.is_active ? 'Pause' : 'Activate'}\r\n                  >\r\n                    {schedule.is_active ? (\r\n                      <Pause className=\"w-5 h-5\" />\r\n                    ) : (\r\n                      <Play className=\"w-5 h-5\" />\r\n                    )}\r\n                  </button>\r\n                  <button\r\n                    onClick={() => {\r\n                      if (\r\n                        confirm(\r\n                          'Are you sure you want to delete this schedule?'\r\n                        )\r\n                      ) {\r\n                        deleteMutation.mutate(schedule.id)\r\n                      }\r\n                    }}\r\n                    className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg\"\r\n                    title=\"Delete\"\r\n                  >\r\n                    <Trash2 className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        <div className=\"text-center py-12 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700\">\r\n          <Calendar className=\"w-12 h-12 mx-auto text-gray-400 mb-4\" />\r\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n            No schedules yet\r\n          </h3>\r\n          <p className=\"text-gray-500 mt-1\">\r\n            Create a schedule to automatically generate digests\r\n          </p>\r\n          <button\r\n            onClick={() => setShowAddForm(true)}\r\n            className=\"mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90\"\r\n          >\r\n            Create First Schedule\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\pages\\Sources.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\PPT NEWS FEED\\frontend\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]